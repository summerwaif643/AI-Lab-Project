\documentclass{article}
\usepackage{listings}
\usepackage{amssymb}
\usepackage{amsfonts} 
\usepackage{amsmath}
\usepackage{multicol}
\usepackage{graphicx}
\usepackage{url}
\usepackage{latexsym}
\usepackage{verbatim}
\usepackage{hyperref}

\newtheorem{definition}{Definition}

\title{AI Lab project: Colorizing images using PyTorch and common AIML techniques  }
\author{Alessandro Candelori, Davide di Trocchio}


\begin{document}
\maketitle
\newpage
\tableofcontents
\newpage


\section{Introduction}
We aim to develop a model in pytorch for image coloring. Its main goal is to colour a never seen 
before, black and white image, ranging from old photographs, decolourized images, sketches and 
black and white media. 
\\ 
The task at hand is a regression model built with inspiration from models like the 
\href{https://arxiv.org/pdf/1611.07004.pdf}{Image-to-Image Transaltion}
and 
\href{https://arxiv.org/pdf/1603.08511.pdf}{Colorful Image Colorization}. 
In particular, we took inspiration from the latter and got really similiar results to their regression
models. 
As we continued to study further, we managed to find many other methods of coloring images, but 
we choose the simplest one, as the other needed too much control and very large datasets, that 
we could not include due to the nature of this project. 
\\
We stressed a classical software development approach as we wanted to study how we could deploy 
AI apps, as opposed to publish our research to a simple Google Colab page or a Jupyter Notebook. 
We like to think that we succeeded in creating a cool, user-level application that could be 
understood and used by everyone. 

\section{Method}
As said in the introduction, we employ a ResNet regression structure to learn related information
from a converted grayscale image. Each image is transposed to a LAB format before learning, extracting 
the features from the grayscale image (using the L channel).

\subsection{LAB format and image processing}
Before processing any image, we aim to bring them to a given resolution ($256 \cross 256$) and then 
convert them from the RGB format to the LAB one. This is done because the RGB format makes it more 
difficult to differentiate colors from the grayscale, whereas in the LAB format we have 
immediately, without computation, the Lightness channel and the color channels (AB) divided from the 
start. 

\begin{figure}[htp]

    %TODO: insert here all subsequents 
    \centering
    \includegraphics[width=.3\textwidth]{i/houghtrain.png}\hfill
    \includegraphics[width=.3\textwidth]{i/houghframe.png}\hfill
    \includegraphics[width=.3\textwidth]{i/houghspace.png}
    
    \caption{default}
    \label{fig:figure 1. The LAB color space. L for including lightness and 
    AB for every other space}
    
    \end{figure}

We will apply regression on the L channel and use the AB channels as the 
ground truth. 

\subsection{The net}
We make use of the ResNet-18, which is an image classification network with 18
layers, of which we will only use 6 modifying the first one to accept grayscale
images. The other layers are simple Convolutional, Batchnorm and upsample 
layers in the order presented inside the code. 
% include image https://i.imgur.com/0DNuHMP.png


\subsection{Loss function}
As the loss function, we work with the simple Mean Squared error. We try to 
minimize the squared distance between the color value we try to predict and the 
actual ground truth color value. 
$$ MSE = \frac{1}{n} \sum^{n}_{i=1}(Y_i - \hat{Y_i})^2$$ 

\subsection{Activation Function}
Since we're using ResNet18, our model is bound to use ReLu. We tried using 
newer techniques such as Mish, but after observing few results we can safely 
say that Mish performs too drastically on this model. 
% Insert image 1, 2 here

\subsection{Optimizer}
We use the Adam optimizer. 

\subsection{The dataset}
As the dataset we used the 

\section{Results and ending}


\section{Credits and links}
\url{https://lukemelas.github.io/image-colorization.html} \\ 
\url{https://colab.research.google.com/github/moein-shariatnia/Deep-Learning/blob/main/Image%20Colorization%20Tutorial/Image%20Colorization%20with%20U-Net%20and%20GAN%20Tutorial.ipynb#scrollTo=mGqbGWUQhzmk}
\url{https://haoyiq.com/project/eecs442/} \\ 


\end{document}
